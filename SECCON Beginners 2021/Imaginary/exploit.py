#
# numbers = '{"1111111 + 1i": [1111111, 1], "1111111111111 + 1337i": [1111111111111, 1337]}'
import json
from ptrlib import Socket
numbers = {}

re1 = 1111111
im1 = 1

re2 = 1111111111111
im2 = 1337

# def insert(re, im):
#     name = f'{re} + {im}i'
#     numbers[name] = [re, im]
# 
# insert(re1, im1)
# insert(re2, im2)
# for chunk in chunks(json.dumps(numbers), 16):
#     print(chunk)

sock = Socket("nc imaginary.quals.beginners.seccon.jp 1337")
sock.sendlineafter("> ", "1")
sock.sendlineafter("> ", str(re1))
sock.sendlineafter("> ", str(im1))

sock.sendlineafter("> ", "1")
sock.sendlineafter("> ", str(re2))
sock.sendlineafter("> ", str(im2))

sock.sendlineafter("> ", "4")
cipher = bytes.fromhex(sock.recvlineafter("Exported:\n").decode())
cipher = cipher[:32] + cipher[48:]


sock.sendlineafter("> ", "3")
sock.sendlineafter("> ", cipher.hex())

sock.sendlineafter("> ", "5")
sock.interactive()


